<!DOCTYPE html>
<html>

<head>
    <title>Share your Google Sheets</title>
</head>

<body>
    <table class="output"></table>
    <div id="divi"></div>
    <script>

        let arryData = [];


        //  'https://docs.google.com/spreadsheets/d/1tibUdKtvqfZPKQJt8tcxC-wLLfdEbwHiieXBbfYEa-Q/edit?usp=sharing';
        const base = 'https://docs.google.com/spreadsheets/d/1tibUdKtvqfZPKQJt8tcxC-wLLfdEbwHiieXBbfYEa-Q/gviz/tq?';
        const output = document.querySelector('.output');
        const query = encodeURIComponent('Select B,C,D,E,F,G');
        const url = base + '&tq=' + query;
        fetch(url)
            .then(res => res.text())
            .then(rep => {
                let data = JSON.parse(rep.substr(47).slice(0, -2));
                console.log(data);
                let row = document.createElement('tr');
                output.append(row);
                data.table.cols.forEach((heading) => {
                    let cell = document.createElement('td');
                    cell.textContent = heading.label;
                    row.append(cell);
                })
                console.log("all data");
                console.log(data.table);
                console.log("col");
                console.log(data.table.cols);
                console.log("length is");
                console.log(data.table.cols.length);
                console.log("row");
                console.log(data.table.rows[5].c[1]);
                console.log("Stop");
                console.log(data.table.rows.length);
                let rowLenght = data.table.rows.length;
                let colLenght = data.table.cols.length;
                for (let i = 0; i < rowLenght; i++) {
                    for (let j = 0; j < 6; j++) {
                        if (j == 1) {
                            document.getElementById('divi').innerHTML += "<a href='" + sliceData(JSON.stringify(data.table.rows[i].c[j])) + "'>" + sliceData(JSON.stringify(data.table.rows[i].c[j])) + "</a>";
                        } else { document.getElementById('divi').innerHTML += sliceData(JSON.stringify(data.table.rows[i].c[j])) + "      "; }

                    }
                    document.getElementById('divi').innerHTML += "<br>";
                }

                document.getElementById('divi').innerHTML += "<h1>Start hare</h1>";

            })

        function sliceData(str) {
            let strNew = str.slice(6);
            strNew = strNew.slice(0, -2);
            return strNew;
        }
    </script>
</body>

</html>